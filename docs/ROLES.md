# Система ролей в боте СТО

В системе бота СТО реализованы две роли пользователей:

## 1. Агент

Основная роль для пользователей, которая предоставляет следующие возможности:
- Запись на ТО для автомобилей категорий B, C, E
- Просмотр своих активных записей
- Просмотр архива записей
- Получение информации о балансе

## 2. Администратор

Расширенная роль, которая включает все функции агента, а также дополнительные возможности:
- Доступ к админ-панели
- Согласование заявок на ТО
- Просмотр списка всех агентов
- Изменение информации о карточках ТО
- Учет расчетов с агентами
- Изменение комиссии агентов

## Процесс регистрации

Регистрация одинакова для обоих типов пользователей:
1. Пользователь вызывает команду /register
2. Бот запрашивает ФИО, телефон, компанию и кодовое слово
3. Система проверяет кодовое слово с сохраненным в настройках
4. При успешной регистрации пользователь получает доступ к функциям бота

## Определение роли

Роль пользователя определяется на основе списка ID администраторов в настройках:
- Если ID пользователя есть в списке ADMIN_IDS, ему назначается роль "Администратор"
- В противном случае назначается роль "Агент"

## Техническая реализация

Система ролей реализована следующим образом:
1. Модель данных `Agent` содержит поле `role` с возможными значениями "agent" или "admin"
2. Декораторы `registered_required` и `admin_required` проверяют права доступа
3. Функция `get_user_role` определяет роль пользователя по его Telegram ID
4. Главное меню адаптируется в зависимости от роли пользователя

## Безопасность

Для обеспечения безопасности:
- Проверка прав доступа выполняется для каждой операции
- Административные функции доступны только пользователям с ролью "Администратор"
- Все действия пользователей логируются
- Для регистрации требуется знание кодового слова 